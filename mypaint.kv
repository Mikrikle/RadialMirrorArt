#:kivy 1.0

<MyPopup>:
    auto_dismiss: False
    title_align:'center'
    size_hint:.95,.85


<CustomDropDownDrawingMode@DrowDownBackground>:
    canvas.before:
        Color: 
            rgba: .05, .05, .05, 1
        RoundedRectangle:
            size:(self.size[0], self.size[1])
            pos:(self.pos[0], self.pos[1])
            radius: [(20, 20), (20, 20), (20, 20), (20, 20)]
    MDRoundFlatIconButton:
        font_size: "5sp"
        text:'Simple'
        icon:'current-ac'
        on_release:root.select(('simple', 'current-ac'))
    MDRoundFlatIconButton:
        font_size: "5sp"
        text:'Mirror'
        icon:'arrow-split-vertical'
        on_release:root.select(('symmetric', 'arrow-split-vertical'))
    MDRoundFlatIconButton:
        font_size: "5sp"
        text:'Double-mirror'
        icon:'crop-square'
        on_release:root.select(('square', 'crop-square'))
    MDRoundFlatIconButton:
        font_size: "5sp"
        text:'Radian'
        icon:'decagram-outline'
        on_release:root.select(('radian', 'decagram-outline'))
    MDRoundFlatIconButton:
        font_size: "5sp"
        text:'Radian-symmetric'
        icon:'decagram'
        on_release:root.select(('radian-symmetric', 'decagram'))



<CustomDropDownNumberOfLines>:
    canvas.before:
        Color: 
            rgba: .05, .05, .05, 1
        RoundedRectangle:
            size:(self.size[0], self.size[1])
            pos:(self.pos[0], self.pos[1])
            radius: [(20, 20), (20, 20), (20, 20), (20, 20)]
    BoxLayout:
        size_hint_y: None
        height: 55
        Widget:
        Label:
            text:'close the lines?'
            size_hint_y: None
            height: 50
        Widget:
        MDSwitch:
            size_hint_y: None
            height: 50
            on_touch_up:root.set_close_lines(self.active)
        Widget:
    Widget:
        size_hint_y: None
        height: 45
    Label:
        text:'Numbers of line\n[sub](For radians mods)[/sub]'
        markup:True
        size_hint_y: None
        height: 50
    MDSlider:
        size_hint_y: None
        height: 100
        min:2
        step: 1
        max:250
        value:root.VALUE
        on_touch_move:root.slider_setattr(int(self.value))
        on_touch_up:root.slider_setattr(int(self.value))


<CustomDropDownLineWidth>:
    canvas.before:
        Color: 
            rgba: .05, .05, .05, 1
        RoundedRectangle:
            size:(self.size[0], self.size[1])
            pos:(self.pos[0], self.pos[1])
            radius: [(20, 20), (20, 20), (20, 20), (20, 20)]
    Widget:
        size_hint_y: None
        height: 50
    Label:
        text:'Lines width'
        size_hint_y: None
        height: 50
    MDSlider:
        size_hint_y: None
        height: 150
        min:1
        step: 1
        max:25
        value:root.VALUE
        on_touch_move:root.slider_setattr(int(self.value))
        on_touch_up:root.slider_setattr(int(self.value))



<ToolBox@BoxLayout>:
    size_hint:(1, .1)
    canvas.before:
        Color: 
            rgba: .1, .1, .1, 1
        Rectangle:
            size:(self.size[0], self.size[1])
            pos:(self.pos[0], self.pos[1])

<ToolBtn@MDFlatButton>:
    background_normal:''
    background_color:.1,.1,.1,1
    size_hint_y:1

<MyPaintWidget>:

<Container>:
    paint:paint
    MyPaintWidget:
        id:paint
        top_toolbox:top_toolbox
        down_toolbox:down_toolbox
        down_current_color_label:down_current_color_label
        down_current_line_width:down_current_line_width
        down_current_nums_of_lines:down_current_nums_of_lines
        drawing_mode_select_btn:drawing_mode_select_btn
        down_current_icon:down_current_icon
        minimize_btn:minimize_btn
        pos_hint:{'x':0, 'y':0}
        size_hint:(1,1)
        canvas.before:
            Color: 
                rgba: .5, .5, .5, 1
            Rectangle:
                size:(2, 2)
                pos:(self.size[0]//2-1, self.size[1]//2-1)


    ToolBox:
        id:top_toolbox
        pos_hint:{'x':0, 'y':.9}
        padding:20
        MDIconButton:
            icon:'delete'
            text:'clear'
            on_release:paint.clear_canvas()
        Widget:
        MDIconButton:
            icon:'undo'
            text:'undo'
            on_release:paint.undo()
        MDIconButton:
            icon:'redo'
            text:'redo'
            on_release:paint.redo()
        Widget:
        MDRoundFlatIconButton:
            id:drawing_mode_select_btn
            icon:'settings'
            text:'Menu'
            on_release:paint.open_settings_popup()

    ToolBox:
        id:down_toolbox
        size_hint:(1,.1)
        paddig:5
        pos_hint:{'x':0, 'y':0}
        BoxLayout:
            id:box
            paddig:10
            Widget:
            MDIconButton:
                size_hint_y:1
                halign: "center"
                id:down_current_icon
                icon:'decagram-outline'
                on_release:paint.dropdown_drawing_mode.open(box)
            ToolBtn:
                id:down_current_nums_of_lines
                text:'Lines\n10'
                on_release:paint.number_of_lines_dropdown.open(box)
            ToolBtn:
                id:down_current_line_width
                text:'Width\n2'
                on_release:paint.line_width_dropdown.open(box)
            ToolBtn:
                id:down_current_color_label
                background_color:.1,.1,.1,1
                on_release:paint.open_color_popup()
                canvas:
                    RoundedRectangle:
                        size:(self.size[0]-20, self.size[1]-20)
                        pos:(self.pos[0]+10, self.pos[1]+10)
                        radius: [(10, 10), (10, 10), (10, 10), (10, 10)]
            Widget:

    MDFloatingActionButton:
        id:minimize_btn
        icon:'arrow-down'
        md_bg_color:.05,.05,.05,1
        text_color: app.theme_cls.primary_color
        user_font_size: "10sp"
        pos_hint:{'x':.86, 'y':.06}
        on_release:paint.minimize_maximize_toolboxes(self.icon)
